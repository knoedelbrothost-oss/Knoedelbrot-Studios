<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
</head>
<body>
    <div id="login-container">Lade Login...</div>

    <script>
    async function loadLogin() {
        try {
            // Holen des Login-HTML von der Hauptdomain (Punycode)
            const res = await fetch("https://xn--kndelbrot-17a.de/login.html");
            const html = await res.text();
            document.getElementById("login-container").innerHTML = html;

            // Formular abfangen
            const form = document.querySelector("#login-container form");
            form.addEventListener("submit", async (e) => {
                e.preventDefault();

                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());

                // Daten per Fetch an die Hauptdomain senden
                const loginRes = await fetch("https://xn--kndelbrot-17a.de/login.html", {
                    method: "POST",
                    credentials: "include", // Cookies werden gesetzt
                    body: new URLSearchParams(data)
                });

                // Pr√ºfen, ob Login erfolgreich war
                if (loginRes.redirected) {
                    // Browser selbst weiterleiten zur Hauptseite (Server hat Redirect gesetzt)
                    window.location.href = loginRes.url;
                } else {
                    alert("Login fehlgeschlagen.");
                }
            });

        } catch (err) {
            console.error("Fehler beim Laden:", err);
            document.getElementById("login-container").innerText = "Login konnte nicht geladen werden.";
        }
    }

    loadLogin();
    </script>
</body>
</html>
